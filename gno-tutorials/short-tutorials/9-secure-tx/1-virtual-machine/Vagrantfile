# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  # Use minimal Alpine Linux (lightweight and secure)
  config.vm.box = "generic/alpine38" # 57MB download
  config.vm.synced_folder "./shared", "/mnt/shared", readonly: true
  
  # Disable all networking (true airgap)
  config.vm.network "private_network", ip: "192.168.33.10", auto_config: false
  config.vm.provision "shell", inline: <<-SHELL
    # Permanently disable networking
    echo -e "auto lo\niface lo inet loopback" > /etc/network/interfaces
    rc-service networking stop
    rc-update del networking boot
  SHELL

  # VM resources (adjust as needed)
  config.vm.provider "virtualbox" do |vb|
    vb.memory = "512"
    vb.cpus = 1
    vb.customize ["modifyvm", :id, "--nic1", "none"] # Remove VirtualBox NIC
  end

  # Provision with essential tools
  config.vm.provision "shell", inline: <<-SHELL
    apk update
    apk add --no-cache gnupg bash curl jq  # Add your tools here
    echo "Airgap VM ready. Network interfaces:"
    ip a
  SHELL
end